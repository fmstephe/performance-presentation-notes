Can do 40MM in ~3 seconds. Not bad.

CPU profile dominated by the better function.
